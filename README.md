I realised I bit off more then I could do.
Gave up on this halfway after doing all the refactoring.
Someone else could take over and use my work if they want to.
